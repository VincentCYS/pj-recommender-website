{"ast":null,"code":"import _regeneratorRuntime from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/vincentchan/Documents/GitHub/pj-recommender-website/src/Components/Details/Details.js\";\nimport React, { Component } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport AddShoppingCartIcon from \"@material-ui/icons/AddShoppingCart\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { addItemInCart } from \"../../Redux/Actions\";\nimport API from \"../../helpers/api.js\";\nimport Item from \"../Item/Item\";\nimport { connect } from \"react-redux\";\nimport Rating from \"react-star-rating-component\";\nimport cookie from \"react-cookies\";\n\nvar ConnectedDetails =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ConnectedDetails, _Component);\n\n  function ConnectedDetails(props) {\n    var _this;\n\n    _classCallCheck(this, ConnectedDetails);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ConnectedDetails).call(this, props));\n    _this.isCompMounted = false;\n    _this.state = {\n      quantity: 1,\n      item: null,\n      rating: 0,\n      relatedItems: [],\n      recent: [],\n      similarImage: [],\n      cfRecipe: [],\n      similarNumSteps: [],\n      similarCalorie: [],\n      cfUserProfileRecipe: [],\n      loading: false,\n      userID: cookie.load(\"userId\")\n    };\n    return _this;\n  } // Gets product and its related items based on product ID.\n\n\n  _createClass(ConnectedDetails, [{\n    key: \"fetchProductUsingID\",\n    value: function () {\n      var _fetchProductUsingID = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(id) {\n        var _this2 = this;\n\n        var item;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  loading: true\n                });\n                item = [];\n                API.get(\"/recipes\", {\n                  id: id\n                }).then(function (res) {\n                  if (res.data.rows.length) {\n                    item = res.data.rows[0];\n                    var date = new Date(item.createDate).toLocaleDateString();\n                    item.createDate = date;\n\n                    if (_this2.isCompMounted) {\n                      _this2.setState({\n                        item: item,\n                        quantity: 1\n                      }, function () {\n                        _this2.getRating();\n\n                        _this2.createBrowseHistory();\n                      });\n                    }\n                  }\n                }).catch(function (err) {\n                  return console.log(err);\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetchProductUsingID(_x) {\n        return _fetchProductUsingID.apply(this, arguments);\n      }\n\n      return fetchProductUsingID;\n    }()\n  }, {\n    key: \"getRelated\",\n    value: function getRelated() {\n      var _this3 = this;\n\n      API.get(\"/similar_recipe_ingredients\", {\n        rid: this.props.match.params.id,\n        uid: this.state.userID\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var relatedItems = res.data.rows;\n\n          if (_this3.isCompMounted) {\n            _this3.setState({\n              relatedItems: relatedItems\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getRating\",\n    value: function getRating() {\n      var _this4 = this;\n\n      API.get(\"/rating\", {\n        rid: this.state.item.id,\n        uid: this.state.userID\n      }).then(function (res) {\n        if (res.data) {\n          _this4.setState({\n            rating: res.data.rows ? res.data.rows[0].rating : 0\n          });\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"createBrowseHistory\",\n    value: function createBrowseHistory() {\n      API.create(\"/browse_history\", {\n        rid: this.props.match.params.id,\n        uid: this.state.userID\n      }).then(function (res) {\n        console.log(res);\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getRecentViewedRecipe\",\n    value: function getRecentViewedRecipe() {\n      var _this5 = this;\n\n      API.get(\"/recent_viewed_recipes\", {\n        uid: this.state.userID\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var recent = res.data.rows;\n\n          if (_this5.isCompMounted) {\n            _this5.setState({\n              recent: recent\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getSimilarRecipeImage\",\n    value: function getSimilarRecipeImage() {\n      var _this6 = this;\n\n      API.get(\"/recipe_image_similarity\", {\n        rid: this.props.match.params.id\n      }).then(function (res) {\n        console.log(\"image\", res);\n\n        if (res.data.rows.length) {\n          var similarImage = res.data.rows;\n\n          if (_this6.isCompMounted) {\n            _this6.setState({\n              similarImage: similarImage,\n              loading: false\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getCFRecipe\",\n    value: function getCFRecipe() {\n      var _this7 = this;\n\n      API.get(\"/cf_recipe\", {\n        uid: this.state.userID,\n        rid: this.props.match.params.id\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var cfRecipe = res.data.rows;\n\n          if (_this7.isCompMounted) {\n            _this7.setState({\n              cfRecipe: cfRecipe,\n              loading: false\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getSimilarNumSteps\",\n    value: function getSimilarNumSteps() {\n      var _this8 = this;\n\n      API.get(\"/similar_num_of_steps_recipe\", {\n        rid: this.props.match.params.id\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var similarNumSteps = res.data.rows;\n\n          if (_this8.isCompMounted) {\n            _this8.setState({\n              similarNumSteps: similarNumSteps,\n              loading: false\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getSimilarCalorie\",\n    value: function getSimilarCalorie() {\n      var _this9 = this;\n\n      API.get(\"/similar_calorie_recipe\", {\n        rid: this.props.match.params.id\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var similarCalorie = res.data.rows;\n\n          if (_this9.isCompMounted) {\n            _this9.setState({\n              similarCalorie: similarCalorie,\n              loading: false\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"getCFUserProfileRecipe\",\n    value: function getCFUserProfileRecipe() {\n      var _this10 = this;\n\n      API.get(\"/cf_user_profile_recipe\", {\n        uid: this.state.userID,\n        rid: this.props.match.params.id\n      }).then(function (res) {\n        if (res.data.rows.length) {\n          var cfUserProfileRecipe = res.data.rows;\n\n          if (_this10.isCompMounted) {\n            _this10.setState({\n              cfUserProfileRecipe: cfUserProfileRecipe,\n              loading: false\n            });\n          }\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      // If ID of product changed in URL, refetch details for that product\n      if (this.props.match.params.id !== prevProps.match.params.id) {\n        this.fetchProductUsingID(this.props.match.params.id);\n        this.getRelated();\n        this.getRating();\n        this.getRecentViewedRecipe();\n        this.getSimilarRecipeImage();\n        this.getCFRecipe();\n        this.getSimilarCalorie();\n        this.getCFUserProfileRecipe();\n        this.getSimilarNumSteps();\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.isCompMounted = true;\n      this.fetchProductUsingID(this.props.match.params.id);\n      this.getRelated();\n      this.getRecentViewedRecipe();\n      this.getSimilarRecipeImage();\n      this.getCFRecipe();\n      this.getSimilarCalorie();\n      this.getCFUserProfileRecipe();\n      this.getSimilarNumSteps();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.isCompMounted = false;\n    }\n  }, {\n    key: \"rateRecipe\",\n    value: function rateRecipe(rating) {\n      var _this11 = this;\n\n      API.create(\"/rating\", {\n        rid: this.props.match.params.id,\n        uid: this.state.userID,\n        rating: rating\n      }).then(function (res) {\n        if (res.result) {\n          _this11.setState({\n            rating: rating\n          });\n        }\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this12 = this;\n\n      if (this.state.loading) {\n        return React.createElement(CircularProgress, {\n          className: \"circular\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 251\n          },\n          __self: this\n        });\n      }\n\n      if (!this.state.item) {\n        return null;\n      }\n\n      return React.createElement(\"div\", {\n        style: {\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          width: \"100%\",\n          display: \"flex\",\n          padding: 10,\n          flexDirection: \"row\",\n          alignItems: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: 20,\n          marginTop: 10,\n          color: \"gray\",\n          fontSize: 20,\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, this.state.item.name), React.createElement(Rating, {\n        style: {\n          flex: 1,\n          marginTop: 5,\n          width: \"100%\"\n        },\n        name: \"Rate\",\n        value: this.state.item.rating || 0\n        /* number of selected icon (`0` - none, `1` - first) */\n        ,\n        editing: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.item.imageUrl,\n        alt: \"\",\n        width: 250,\n        height: 250,\n        style: {\n          borderRadius: \"5%\",\n          objectFit: \"cover\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 20,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }, \"Recipe Description\"), React.createElement(\"div\", {\n        style: {\n          marginLeft: 5,\n          maxHeight: 200,\n          fontSize: 13,\n          overflow: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          fontSize: 18,\n          marginTop: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, \"Ingredients\", this.state.item.ingredient_list.split(\",\").map(function (v) {\n        return React.createElement(\"div\", {\n          style: {\n            fontSize: 18,\n            marginTop: 10\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 320\n          },\n          __self: this\n        }, v + \"\\n\");\n      })), React.createElement(\"div\", {\n        style: {\n          fontSize: 18,\n          marginTop: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }, \"Steps\", this.state.item.detailStep.split(\".,\").map(function (v, i) {\n        return React.createElement(\"div\", {\n          style: {\n            fontSize: 18,\n            marginTop: 10\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 326\n          },\n          __self: this\n        }, \"Step \".concat(i, \" \").concat(v, \"\\n\"));\n      })), React.createElement(\"div\", {\n        style: {\n          fontSize: 18,\n          marginTop: 40\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, \"Created Date : \", this.state.item.createDate), React.createElement(\"div\", {\n        style: {\n          fontSize: 18,\n          marginTop: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, \"Calorie : \", this.state.item.calorie), React.createElement(\"div\", {\n        style: {\n          width: 100,\n          marginLeft: 20,\n          marginTop: 20,\n          display: \"flex\",\n          flexDirection: \"column\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }, \"Your Rate\", React.createElement(Rating, {\n        style: {\n          flex: 1,\n          marginTop: 5,\n          width: \"100%\"\n        },\n        name: \"Rate\",\n        value: this.state.rating || 0\n        /* number of selected icon (`0` - none, `1` - first) */\n        ,\n        onStarClick: function onStarClick(nextValue) {\n          return _this12.rateRecipe(nextValue);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 347\n        },\n        __self: this\n      })), JSON.stringify(this.state.relatedItems[0]) != \"{}\" && this.state.relatedItems.length ? React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, \"Related Recipes\") : null, JSON.stringify(this.state.relatedItems[0]) != \"{}\" ? this.state.relatedItems.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 372\n          },\n          __self: this\n        });\n      }) : null, this.state.similarImage.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }, \"Similar Finishing Recipes\"), this.state.similarImage.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 390\n          },\n          __self: this\n        });\n      })) : null, this.state.similarCalorie.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 398\n        },\n        __self: this\n      }, \"Similar Calorie Recipes\"), this.state.similarCalorie.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 409\n          },\n          __self: this\n        });\n      })) : null, this.state.similarNumSteps.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 416\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      }, \"Similar Difficulty Recipes\"), this.state.similarNumSteps.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 428\n          },\n          __self: this\n        });\n      })) : null, this.state.recent.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }, \"Recent Viewed Recipes\"), this.state.recent.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 448\n          },\n          __self: this\n        });\n      })) : null, this.state.cfUserProfileRecipe.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 459\n        },\n        __self: this\n      }, \"Liked by Similar User\"), this.state.cfUserProfileRecipe.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 470\n          },\n          __self: this\n        });\n      })) : null, this.state.cfRecipe.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginTop: 30,\n          marginBottom: 10,\n          color: \"gray\",\n          fontSize: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479\n        },\n        __self: this\n      }, \"Liked by Similar User\"), this.state.cfRecipe.map(function (x) {\n        return React.createElement(Item, {\n          key: x.id,\n          item: x,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 490\n          },\n          __self: this\n        });\n      })) : null);\n    }\n  }]);\n\n  return ConnectedDetails;\n}(Component);\n\nvar Details = connect()(ConnectedDetails);\nexport default Details;","map":{"version":3,"sources":["/Users/vincentchan/Documents/GitHub/pj-recommender-website/src/Components/Details/Details.js"],"names":["React","Component","Button","AddShoppingCartIcon","CircularProgress","addItemInCart","API","Item","connect","Rating","cookie","ConnectedDetails","props","isCompMounted","state","quantity","item","rating","relatedItems","recent","similarImage","cfRecipe","similarNumSteps","similarCalorie","cfUserProfileRecipe","loading","userID","load","id","setState","get","then","res","data","rows","length","date","Date","createDate","toLocaleDateString","getRating","createBrowseHistory","catch","err","console","log","rid","match","params","uid","create","prevProps","prevState","snapshot","fetchProductUsingID","getRelated","getRecentViewedRecipe","getSimilarRecipeImage","getCFRecipe","getSimilarCalorie","getCFUserProfileRecipe","getSimilarNumSteps","result","padding","width","display","flexDirection","alignItems","marginBottom","marginTop","color","fontSize","marginRight","name","flex","imageUrl","borderRadius","objectFit","marginLeft","maxHeight","overflow","ingredient_list","split","map","v","detailStep","i","calorie","nextValue","rateRecipe","JSON","stringify","x","Details"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport AddShoppingCartIcon from \"@material-ui/icons/AddShoppingCart\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { addItemInCart } from \"../../Redux/Actions\";\nimport API from \"../../helpers/api.js\";\nimport Item from \"../Item/Item\";\nimport { connect } from \"react-redux\";\nimport Rating from \"react-star-rating-component\";\nimport cookie from \"react-cookies\";\n\nclass ConnectedDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.isCompMounted = false;\n\n    this.state = {\n      quantity: 1,\n      item: null,\n      rating: 0,\n\n      relatedItems: [],\n      recent: [],\n      similarImage: [],\n      cfRecipe: [],\n      similarNumSteps : [],\n      similarCalorie : [],\n      cfUserProfileRecipe : [],\n\n      loading: false,\n      userID: cookie.load(\"userId\")\n    };\n  }\n\n  // Gets product and its related items based on product ID.\n  async fetchProductUsingID(id) {\n    this.setState({ loading: true });\n    var item = [];\n    API.get(\"/recipes\", { id: id })\n      .then(res => {\n        if (res.data.rows.length) {\n          item = res.data.rows[0];\n          var date = new Date(item.createDate).toLocaleDateString();\n          item.createDate = date;\n          if (this.isCompMounted) {\n            this.setState(\n              {\n                item,\n                quantity: 1,\n              },\n              () => {\n                this.getRating();\n                this.createBrowseHistory();\n              }\n            );\n          }\n        }\n      })\n      .catch(err => console.log(err));\n\n   \n  }\n\n  getRelated() {\n    API.get(\"/similar_recipe_ingredients\", { rid: this.props.match.params.id, uid : this.state.userID })\n    .then(res => {\n      if (res.data.rows.length) {\n        var relatedItems = res.data.rows;\n\n        if (this.isCompMounted) {\n          this.setState({\n            relatedItems,\n          });\n        }\n      }\n    })\n    .catch(err => console.log(err));\n  }\n \n  getRating() {\n    API.get(\"/rating\", { rid: this.state.item.id, uid: this.state.userID })\n      .then(res => {\n        if (res.data) {\n          this.setState({\n            rating: res.data.rows ? res.data.rows[0].rating : 0\n          });\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  createBrowseHistory() {\n    API.create(\"/browse_history\", {\n      rid: this.props.match.params.id,\n      uid: this.state.userID\n    })\n      .then(res => {\n        console.log(res);\n      })\n      .catch(err => console.log(err));\n  }\n\n  getRecentViewedRecipe() {\n    API.get(\"/recent_viewed_recipes\", { uid: this.state.userID })\n      .then(res => {\n        if (res.data.rows.length) {\n          var recent = res.data.rows;\n\n          if (this.isCompMounted) {\n            this.setState({\n              recent,\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  getSimilarRecipeImage() {\n    API.get(\"/recipe_image_similarity\", { rid: this.props.match.params.id, })\n      .then(res => {\n        console.log(\"image\", res);\n\n        if (res.data.rows.length) {          \n          var similarImage = res.data.rows;\n          if (this.isCompMounted) {\n            this.setState({\n              similarImage,\n              loading : false\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  getCFRecipe() {\n    API.get(\"/cf_recipe\", { uid: this.state.userID, rid: this.props.match.params.id })\n      .then(res => {\n        if (res.data.rows.length) {\n          var cfRecipe = res.data.rows;\n          if (this.isCompMounted) {\n            this.setState({\n              cfRecipe,\n              loading: false\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  getSimilarNumSteps() {\n    API.get(\"/similar_num_of_steps_recipe\", { rid: this.props.match.params.id })\n      .then(res => {\n        if (res.data.rows.length) {\n          var similarNumSteps = res.data.rows;\n          if (this.isCompMounted) {\n            this.setState({\n              similarNumSteps,\n              loading: false\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  getSimilarCalorie() {\n    API.get(\"/similar_calorie_recipe\", { rid: this.props.match.params.id })\n      .then(res => {\n        if (res.data.rows.length) {\n          var similarCalorie = res.data.rows;\n          if (this.isCompMounted) {\n            this.setState({\n              similarCalorie,\n              loading: false\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  getCFUserProfileRecipe() {\n    API.get(\"/cf_user_profile_recipe\", { uid: this.state.userID, rid : this.props.match.params.id  })\n      .then(res => {\n        if (res.data.rows.length) {\n          var cfUserProfileRecipe = res.data.rows;\n          if (this.isCompMounted) {\n            this.setState({\n              cfUserProfileRecipe,\n              loading: false\n            });\n          }\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    // If ID of product changed in URL, refetch details for that product\n    if (this.props.match.params.id !== prevProps.match.params.id) {\n      this.fetchProductUsingID(this.props.match.params.id);\n      this.getRelated();\n      this.getRating();\n      this.getRecentViewedRecipe();\n      this.getSimilarRecipeImage();\n      this.getCFRecipe();\n      this.getSimilarCalorie();\n      this.getCFUserProfileRecipe();\n      this.getSimilarNumSteps();\n    }\n  }\n\n  componentDidMount() {\n    this.isCompMounted = true;\n    this.fetchProductUsingID(this.props.match.params.id);\n    this.getRelated();\n    this.getRecentViewedRecipe();\n    this.getSimilarRecipeImage();\n    this.getCFRecipe();\n    this.getSimilarCalorie();\n    this.getCFUserProfileRecipe();\n    this.getSimilarNumSteps();\n  }\n\n  componentWillUnmount() {\n    this.isCompMounted = false;\n  }\n\n  rateRecipe(rating) {\n    API.create(\"/rating\", {\n      rid: this.props.match.params.id,\n      uid: this.state.userID,\n      rating\n    })\n      .then(res => {\n        if (res.result) {\n          this.setState({\n            rating: rating\n          });\n        }\n      })\n      .catch(err => console.log(err));\n  }\n\n  render() {\n    if (this.state.loading) {\n      return <CircularProgress className=\"circular\" />;\n    }\n\n    if (!this.state.item) {\n      return null;\n    }\n    return (\n      <div style={{ padding: 10 }}>\n        <div\n          style={{\n            width: \"100%\",\n            display: \"flex\",\n            padding: 10,\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          }}\n        >\n          <div\n            style={{\n              marginBottom: 20,\n              marginTop: 10,\n              color: \"gray\",\n              fontSize: 20,\n              marginRight: 20\n            }}\n          >\n            {this.state.item.name}\n          </div>\n\n          <Rating\n            style={{ flex: 1, marginTop: 5, width: \"100%\" }}\n            name={\"Rate\"}\n            value={\n              this.state.item.rating || 0\n            } /* number of selected icon (`0` - none, `1` - first) */\n            editing={false}\n          />\n        </div>\n        <div style={{ display: \"flex\" }}>\n          <img\n            src={this.state.item.imageUrl}\n            alt=\"\"\n            width={250}\n            height={250}\n            style={{ borderRadius: \"5%\", objectFit: \"cover\" }}\n          />\n        </div>\n        {/* Recipe description */}\n        <div\n          style={{\n            marginTop: 30,\n            marginBottom: 20,\n            color: \"gray\",\n            fontSize: 20\n          }}\n        >\n          Recipe Description\n        </div>\n        <div\n          style={{\n            marginLeft: 5,\n            maxHeight: 200,\n            fontSize: 13,\n            overflow: \"auto\"\n          }}\n        ></div>\n        <div style={{ fontSize: 18, marginTop: 10 }}>\n          Ingredients\n          {this.state.item.ingredient_list.split(\",\").map(v => (\n            <div style={{ fontSize: 18, marginTop: 10 }}>{v + \"\\n\"}</div>\n          ))}\n        </div>\n        <div style={{ fontSize: 18, marginTop: 20 }}>\n          Steps\n          {this.state.item.detailStep.split(\".,\").map((v, i) => (\n            <div\n              style={{ fontSize: 18, marginTop: 10 }}\n            >{`Step ${i} ${v}\\n`}</div>\n          ))}\n        </div>\n        <div style={{ fontSize: 18, marginTop: 40 }}>\n          Created Date : {this.state.item.createDate}\n        </div>\n        <div style={{ fontSize: 18, marginTop: 10 }}>\n          Calorie : {this.state.item.calorie}\n        </div>\n        <div\n          style={{\n            width: 100,\n            marginLeft: 20,\n            marginTop: 20,\n            display: \"flex\",\n            flexDirection: \"column\"\n          }}\n        >\n          Your Rate\n          <Rating\n            style={{ flex: 1, marginTop: 5, width: \"100%\" }}\n            name={\"Rate\"}\n            value={\n              this.state.rating || 0\n            } /* number of selected icon (`0` - none, `1` - first) */\n            onStarClick={nextValue => this.rateRecipe(nextValue)}\n          />\n        </div>\n        {/* Relateditems */}\n        {JSON.stringify(this.state.relatedItems[0]) != \"{}\" &&\n        this.state.relatedItems.length ? (\n          <div\n            style={{\n              marginTop: 30,\n              marginBottom: 10,\n              color: \"gray\",\n              fontSize: 20\n            }}\n          >\n            Related Recipes\n          </div>\n        ) : null}\n        {JSON.stringify(this.state.relatedItems[0]) != \"{}\"\n          ? this.state.relatedItems.map(x => {\n              return <Item key={x.id} item={x} />;\n            })\n          : null}\n\n        {/* Similar Finishing items */}\n        {this.state.similarImage.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Similar Finishing Recipes\n            </div>\n            {this.state.similarImage.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n\n        {/* Similar Calorie*/}\n        {this.state.similarCalorie.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Similar Calorie Recipes\n            </div>\n            {this.state.similarCalorie.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n\n           {/* Similar Number of Steps */}\n           {this.state.similarNumSteps.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Similar Difficulty Recipes\n            </div>\n            {this.state.similarNumSteps.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n\n\n        {/* Recent Viewed items */}\n        {this.state.recent.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Recent Viewed Recipes\n            </div>\n            {this.state.recent.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n     \n\n\n        \n        {/* CF Based on User Profile Recipes */}\n        {this.state.cfUserProfileRecipe.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Liked by Similar User\n            </div>\n            {this.state.cfUserProfileRecipe.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n\n\n        {/* CF Based on User Rating Recipes */}\n        {this.state.cfRecipe.length ? (\n          <div>\n            <div\n              style={{\n                marginTop: 30,\n                marginBottom: 10,\n                color: \"gray\",\n                fontSize: 20\n              }}\n            >\n              Liked by Similar User\n            </div>\n            {this.state.cfRecipe.map(x => {\n              return <Item key={x.id} item={x} />;\n            })}\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nlet Details = connect()(ConnectedDetails);\nexport default Details;\n"]},"metadata":{},"sourceType":"module"}